"use strict";class EduNetSanitizer{constructor(){this.hasDOMPurify="undefined"!=typeof DOMPurify,this.allowedTags=["p","br","b","i","u","strong","em","span","ul","ol","li","a","blockquote","code","pre"],this.allowedAttributes={a:["href","title","target","rel"],span:["class"],code:["class"],pre:["class"]},this.dangerousPatterns=[/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,/javascript:/gi,/on\w+\s*=/gi,/data:/gi,/vbscript:/gi,/expression\s*\(/gi],console.log("üõ°Ô∏è EduNetSanitizer initialized - DOMPurify: "+(this.hasDOMPurify?"available":"fallback mode"))}sanitize(t,e={}){return t&&"string"==typeof t?this.hasDOMPurify?DOMPurify.sanitize(t,{ALLOWED_TAGS:e.allowedTags||this.allowedTags,ALLOWED_ATTR:e.allowedAttr||["href","title","target","rel","class"],ALLOW_DATA_ATTR:!1,...e}):this.manualSanitize(t,e):""}manualSanitize(t,e={}){let a=t;for(const t of this.dangerousPatterns)a=a.replace(t,"");return a=this.escapeHtml(a),e.allowBasicFormatting&&(a=this.restoreSafeTags(a)),a}escapeHtml(t){if(!t||"string"!=typeof t)return"";const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return t.replace(/[&<>"'`=/]/g,t=>e[t])}restoreSafeTags(t){const e=[{escaped:"&lt;b&gt;",tag:"<b>"},{escaped:"&lt;/b&gt;",tag:"</b>"},{escaped:"&lt;i&gt;",tag:"<i>"},{escaped:"&lt;/i&gt;",tag:"</i>"},{escaped:"&lt;u&gt;",tag:"<u>"},{escaped:"&lt;/u&gt;",tag:"</u>"},{escaped:"&lt;strong&gt;",tag:"<strong>"},{escaped:"&lt;/strong&gt;",tag:"</strong>"},{escaped:"&lt;em&gt;",tag:"<em>"},{escaped:"&lt;/em&gt;",tag:"</em>"},{escaped:"&lt;br&gt;",tag:"<br>"},{escaped:"&lt;br/&gt;",tag:"<br>"},{escaped:"&lt;br /&gt;",tag:"<br>"},{escaped:"&lt;p&gt;",tag:"<p>"},{escaped:"&lt;/p&gt;",tag:"</p>"}];let a=t;for(const{escaped:t,tag:s}of e)a=a.split(t).join(s);return a}sanitizeAttribute(t){return t&&"string"==typeof t?t.replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/javascript:/gi,"").replace(/on\w+=/gi,""):""}sanitizeUrl(t){if(!t||"string"!=typeof t)return"";t=t.trim();const e=["javascript:","data:","vbscript:","file:"],a=t.toLowerCase();for(const t of e)if(a.startsWith(t))return"";const s=["http://","https://","mailto:","tel:","//","/"],i=s.some(t=>a.startsWith(t));return i||t.includes(":")?i?t:"":t}sanitizeForJson(t){return t&&"string"==typeof t?t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t"):""}createElement(t,e={},a=""){this.allowedTags.includes(t.toLowerCase())||(t="span");const s=document.createElement(t),i=this.allowedAttributes[t]||[];for(const[t,a]of Object.entries(e))(i.includes(t)||"class"===t||"id"===t)&&s.setAttribute(t,this.sanitizeAttribute(a));return a&&(s.textContent=a),s}setInnerHTML(t,e,a={}){t&&(t.innerHTML=this.sanitize(e,a))}setTextContent(t,e){t&&(t.textContent=e||"")}}window.sanitizer=new EduNetSanitizer,window.escapeHtml=t=>window.sanitizer.escapeHtml(t),window.sanitizeHtml=(t,e)=>window.sanitizer.sanitize(t,e);